# AIOEP 模块设计

> 状态: **已确认** | 版本: v1.0.0 | 创建: 2026-02-17
>
> 本文档定义 AIOEP 平台的模块拆分、职责、接口、依赖关系和开发计划。
> 上游文档：[AIOEP-战略规划.md](./AIOEP-战略规划.md) | [AIOEP-设计.md](./AIOEP-设计.md)

---

## 1. 模块总览

```
AIOEP 平台 — 8 个模块
│
├── 核心层（v0.1 必须）
│   ├── M1 方法论内核      ← 方法论的结构化存储和导航
│   ├── M2 方法引擎        ← 方法+模板的管理和执行跟踪
│   ├── M3 项目上下文      ← 项目状态感知，AI 自动恢复上下文
│   └── M4 Skills 引擎    ← AI 可执行的方法指令
│
├── 集成层（v0.1 部分 + v0.2）
│   ├── M5 Cursor 集成    ← Rules/Skills 自动管理
│   └── M6 外部工具集成    ← Archi/draw.io/GitHub 桥接
│
└── 扩展层（v0.3+）
    ├── M7 多项目管理      ← 跨项目共享和复用
    └── M8 Web 看板        ← 可视化管理界面
```

---

## 2. 模块依赖关系

```
        ┌──────────┐
        │M1 方法论 │
        │   内核   │
        └────┬─────┘
             │
     ┌───────┼───────┐
     ▼       ▼       ▼
┌────────┐┌──────┐┌──────┐
│M2 方法 ││M3 项 ││M6 外 │
│  引擎  ││目上下││部工具│
│        ││  文  ││ 集成 │
└────┬───┘└──┬───┘└──────┘
     │       │
     └───┬───┘
         ▼
    ┌─────────┐
    │M4 Skills│
    │   引擎  │
    └────┬────┘
         │
         ▼
    ┌─────────┐
    │M5 Cursor│
    │   集成  │
    └────┬────┘
         │
    ┌────┼────┐
    ▼         ▼
┌──────┐ ┌──────┐
│M7 多 │ │M8 Web│
│项目  │ │ 看板 │
│管理  │ │      │
└──────┘ └──────┘
```

**依赖规则**：箭头方向 = 被依赖方向。M4 依赖 M2+M3，意味着 M2、M3 要先可用。

---

## 3. 各模块详细设计

---

### M1 方法论内核 (Methodology Core)

**一句话**：AI-EADM 9 域方法论的结构化存储、导航和版本管理。

| 维度 | 内容 |
|------|------|
| **职责** | 存储和组织 AI-EADM 9 域方法论文档；提供域级和文件级的导航结构；维护文档状态（纲要/已确认/已验证）和版本 |
| **不做** | 不包含具体方法步骤（那是 M2）；不处理项目实例文档 |
| **核心接口** | 输入：方法论文档（Markdown 文件）<br>输出：结构化的 9 域索引 + 文档状态矩阵 |
| **依赖** | 无（最底层模块） |
| **被依赖** | M2 方法引擎、M3 项目上下文、M6 外部工具集成 |

**v0.1 实现**：
- 形态：`docs/00-方法论/` 目录结构 + 各域 README.md
- 导航：`docs/00-方法论/README.md` 中的 WBS 文档索引
- 状态追踪：每个文档头部的 `状态: 纲要/已确认/已验证`
- 已有资产：9 域目录已建立，核心 4 文件已确认

**v0.2 演进**：CLI 命令 `aioep methodology status` 自动扫描文档状态

**ERP 验证场景**：ERP Phase 1 开始时，AI 能否通过 00-方法论/ 找到正确的方法论指导

---

### M2 方法引擎 (Method Engine)

**一句话**：实践方法和模板的管理，按活动阶段导航，支持方法执行跟踪。

| 维度 | 内容 |
|------|------|
| **职责** | 按阶段组织方法文件（分析/开发/交付）；管理方法模板（空白模板供项目复制使用）；定义方法文件的标准格式（定位/前置/步骤/模板/检查清单/输出） |
| **不做** | 不存储项目的方法执行结果（那是项目仓库的 02-项目/）；不直接指挥 AI（那是 M4） |
| **核心接口** | 输入：当前阶段 + 当前活动（来自 M3）<br>输出：对应的方法文件路径 + 模板文件路径 |
| **依赖** | M1（方法引用方法论中的框架） |
| **被依赖** | M4 Skills 引擎（Skill 引用方法文件） |

**v0.1 实现**：
- 形态：`docs/01-方法/` 目录结构（分析方法/开发方法/交付方法）
- 方法文件格式：已定义标准格式（见战略规划方法.md）
- 模板管理：模板文件以 `模板-` 前缀命名，放在对应方法目录下
- 已有资产：战略规划方法（已细化）、Gap-Fit 方法（纲要）、需求建模方法（纲要）

**v0.2 演进**：CLI 命令 `aioep method list` 列出可用方法

**ERP 验证场景**：ERP Gap-Fit 分析时，AI 能否按方法文件的步骤逐步执行

---

### M3 项目上下文 (Project Context)

**一句话**：项目状态的自动感知，让 AI 每次对话都知道"做到哪了"。

| 维度 | 内容 |
|------|------|
| **职责** | 定义项目上下文的标准格式（project-context.md）；维护当前阶段/活动/步骤进度；记录上次对话摘要和下一步行动；提供方法文件路径引用 |
| **不做** | 不存储对话历史（那是 Chatlog）；不管理多个项目（那是 M7） |
| **核心接口** | 输入：人工更新或 AI 辅助更新的状态信息<br>输出：结构化的项目上下文（Cursor Rule 格式，AI 每次对话自动读取） |
| **依赖** | M1（引用方法论阶段定义） |
| **被依赖** | M4 Skills 引擎（读取上下文决定加载哪个 Skill）、M7 多项目管理 |

**v0.1 实现**：
- 形态：`项目仓库/.cursor/rules/project-context.md`
- 格式：Cursor Rule 格式（带 frontmatter `globs: ["**"]`，每次对话自动加载）
- 内容字段：项目名称、方法论版本、当前阶段、当前活动、活动进度、方法文件路径、上次对话摘要、下一步行动
- 更新方式：每次对话结束时 AI 辅助更新（或人工更新）

**v0.2 演进**：CLI 命令 `aioep status` 读取并展示项目上下文；`aioep advance` 推进到下一步

**ERP 验证场景**：新开一个 Cursor 对话，AI 是否能自动读取 project-context.md 并知道 ERP 当前在 Phase 1 的哪个步骤

**project-context.md 格式规范**：

```markdown
---
description: 项目上下文。AI 每次对话自动读取，了解当前状态。
globs: ["**"]
---

# 项目上下文

- 项目: [项目名称]
- 方法论: AI-EADM v0.x
- AIOEP 仓库: [路径或URL]
- 当前阶段: Phase N（阶段名称）
- 当前活动: [活动名称]
- 活动进度: Step X/Y（步骤描述）
- 方法文件: [AIOEP 仓库中的方法文件路径]
- 上次对话: [简述上次做了什么]
- 下一步: [明确的下一步行动]
```

---

### M4 Skills 引擎 (Skills Engine)

**一句话**：AI 可执行的方法指令，三级颗粒度，自动匹配当前活动。

| 维度 | 内容 |
|------|------|
| **职责** | 管理 L1/L2/L3 三级 Skills；定义 Skill 的标准格式（SKILL.md）；将方法文件转化为 AI 可执行的精简指令；提供 Skill 与方法文件、模板、检查清单的映射关系 |
| **不做** | 不重复方法文件内容（Skill 引用方法文件，不复制）；不管理 Cursor 的 Skill 加载机制（那是 M5） |
| **核心接口** | 输入：当前活动（来自 M3）+ 对应方法文件（来自 M2）<br>输出：SKILL.md 文件（Cursor Skills 格式） |
| **依赖** | M2（引用方法文件）、M3（读取当前活动） |
| **被依赖** | M5 Cursor 集成（将 Skill 部署到项目仓库的 .cursor/skills/） |

**三级颗粒度**：

| 级别 | 名称 | 触发方式 | 内容 | 示例 |
|------|------|---------|------|------|
| L1 | 阶段级 | "开始 Phase 1" | 该阶段的活动导航和流程总览 | phase-1-analysis |
| L2 | 方法级 | "做 Gap-Fit 分析" | 具体方法的步骤引导 | gap-fit-analysis |
| L3 | 步骤级 | "画采购流程 BPMN" | 单个步骤的操作指南 | bpmn-draw-purchase |

**v0.1 实现**：
- 存储位置：AIOEP 仓库 `skills/` 目录（模板源头）
- 部署位置：项目仓库 `.cursor/skills/` 目录（Cursor 自动加载）
- 同步方式：手动复制（v0.2 由 CLI 自动化）
- 首个 Skill：`phase-1-analysis/SKILL.md`（L1 级）

**SKILL.md 标准格式**：

```markdown
---
description: [Skill 描述，用于 Cursor 匹配]
---

# [Skill 名称]

## 上下文
1. 读取项目上下文：`.cursor/rules/project-context.md`
2. 确认当前阶段和活动

## 方法引用
- 方法文件：`[AIOEP 仓库路径]`
- 模板文件：`[模板路径]`

## 执行步骤
[按方法文件的步骤，精简为 AI 可执行的指令]

## 输出要求
[输出格式和存放位置]

## 自检清单
[引用方法文件的检查清单]

## 完成后
- 更新 project-context.md 进度
- 更新 Chatlog.md
```

**v0.2 演进**：CLI 命令 `aioep skill list` / `aioep skill sync`

**ERP 验证场景**：触发 "开始 Phase 1" 后，AI 是否能按 Skill 引导完成阶段导航

---

### M5 Cursor 集成 (Cursor Integration)

**一句话**：管理 Cursor Rules 和 Skills 的生成、同步和配置。

| 维度 | 内容 |
|------|------|
| **职责** | 将 AIOEP 的 Rules 模板部署到项目仓库的 `.cursor/rules/`；将 Skills 同步到项目仓库的 `.cursor/skills/`；管理 Cursor 多根工作区配置 |
| **不做** | 不定义 Skill 内容（那是 M4）；不修改 Cursor IDE 本身 |
| **核心接口** | 输入：Rules 模板（来自 AIOEP rules/）+ Skills 文件（来自 M4）<br>输出：项目仓库 .cursor/ 目录中的文件 |
| **依赖** | M4（提供 Skill 文件） |
| **被依赖** | M7（新项目初始化需要部署 Rules/Skills）、M8 |

**v0.1 实现**：
- Rules 模板：AIOEP 仓库 `rules/` 目录存放通用模板
- 部署方式：手动复制到项目仓库 `.cursor/rules/`
- 项目特定 Rules：直接在项目仓库 `.cursor/rules/` 创建和维护
- 多根工作区：手动配置（文档指导）

**v0.2 演进**：CLI 命令 `aioep sync` 自动同步

**ERP 验证场景**：ERP 仓库的 `.cursor/rules/` 和 `.cursor/skills/` 是否正确加载

---

### M6 外部工具集成 (External Tool Integration)

**一句话**：连接 Archi、draw.io、GitHub 等外部工具的桥接层。

| 维度 | 内容 |
|------|------|
| **职责** | 定义 ArchiMate 模型的文件组织规范；定义 BPMN/UML/C4 的 draw.io 文件规范；GitHub 工作流集成（CI/CD、Issue 模板） |
| **不做** | 不实现工具本身的功能；不自动化建模过程（v1.0+ 可能） |
| **核心接口** | 输入：建模规范（来自 M1 方法论中的建模体系）<br>输出：模型文件组织规范 + 工具配置模板 |
| **依赖** | M1（建模体系定义） |
| **被依赖** | 无直接依赖 |

**v0.1 实现**：
- 形态：文档规范（已有 `models/` 目录结构定义）
- Archi：手动使用 Archi 工具，模型文件存入 `models/archimate/`
- draw.io：手动使用，文件存入 `models/bpmn/` `models/uml/` `models/c4/`
- GitHub：已有 CI 工作流（`.github/workflows/ci.yml`）

**v0.3 演进**：可能自动生成 draw.io XML 模板

**ERP 验证场景**：ERP Phase 1 建模时，模型文件是否按规范组织

---

### M7 多项目管理 (Multi-Project Management)

**一句话**：支持多个项目共享 AIOEP 方法论，各项目独立运行。

| 维度 | 内容 |
|------|------|
| **职责** | 定义共享层/项目层的分离规范；项目初始化（从 AIOEP 模板创建新项目）；跨项目的方法演进同步 |
| **不做** | 不管理项目内部的文档和代码（那是项目仓库自己的事） |
| **核心接口** | 输入：项目模板 + 项目配置<br>输出：初始化完成的项目仓库 |
| **依赖** | M3（每个项目有自己的 project-context）、M5（每个项目需要 Rules/Skills） |
| **被依赖** | M8 Web 看板（展示多项目状态） |

**v0.1 实现**：
- 形态：目录约定文档（已在 AIOEP-设计.md 第 6 节定义）
- 共享层：AIOEP 仓库（方法论 + 方法 + Skills 模板）
- 项目层：各项目独立仓库（ERP 是第一个）
- 初始化：手动按文档创建

**v0.2 演进**：CLI 命令 `aioep init <project-name>` 自动创建项目仓库骨架

**v0.3 验证场景**：用 AIOEP 启动第二个项目实例

---

### M8 Web 看板 (Web Dashboard)

**一句话**：可视化的多项目管理界面，展示方法导航和项目状态。

| 维度 | 内容 |
|------|------|
| **职责** | 多项目状态看板；方法论浏览和导航；Skills 在线管理；质量门禁可视化 |
| **不做** | 不替代 Cursor 作为开发 UI；不存储原始数据（读取文件系统或 API） |
| **核心接口** | 输入：各项目的 project-context + AIOEP 方法论文档<br>输出：Web UI |
| **依赖** | M5（读取 Cursor 配置）、M7（读取多项目信息） |
| **被依赖** | 无（最上层 UI） |

**v0.1 实现**：不实现（使用已有的 erp-portal 作为原型参考）

**v0.3 演进**：基于 erp-portal 重构为 AIOEP 看板

**现有资产**：erp-portal（Next.js + Supabase）已有仪表盘、方法论浏览器、路线图、质量门禁等页面

---

## 4. 开发顺序

### v0.1 开发路径（当前）

```
Step 1: M1 方法论内核     → 已完成（目录结构+文档已建立）
Step 2: M3 项目上下文     → 创建 project-context.md
Step 3: M2 方法引擎       → 已部分完成（方法目录+格式已定义）
Step 4: M4 Skills 引擎    → 创建第一个 Skill
Step 5: M5 Cursor 集成    → 部署 Rules + Skills 到 ERP 仓库
```

### v0.2 开发路径

```
Step 1: M4 Skills 扩展    → Phase 1 全活动 L1/L2 Skills
Step 2: M5 CLI 化         → aioep sync 命令
Step 3: M7 项目初始化     → aioep init 命令
Step 4: M2 方法完善       → Phase 2 方法文件细化
```

### v0.3 开发路径

```
Step 1: M8 Web 看板       → erp-portal 重构
Step 2: M7 多项目验证     → 第二个项目实例
Step 3: M6 工具集成增强   → 建模模板自动生成
```

---

## 5. 模块 x 版本矩阵

| 模块 | v0.1 | v0.2 | v0.3 | v1.0 |
|------|------|------|------|------|
| M1 方法论内核 | **目录+文档** | 状态扫描CLI | - | 定制化 |
| M2 方法引擎 | **目录+格式** | 方法列表CLI | - | 方法市场 |
| M3 项目上下文 | **project-context.md** | status/advance CLI | - | 自动更新 |
| M4 Skills 引擎 | **首个Skill** | Phase 1 全覆盖 | Phase 2 覆盖 | Skills 市场 |
| M5 Cursor 集成 | **手动部署** | sync CLI | - | IDE 插件 |
| M6 外部工具集成 | 文档规范 | - | 模板生成 | 自动化桥接 |
| M7 多项目管理 | 目录约定 | **init CLI** | **验证** | 完整管理 |
| M8 Web 看板 | - | - | **MVP** | 完整UI |

> 加粗 = 该版本的核心交付

---

## 6. 关键设计原则

1. **文件系统优先**：所有模块的 v0.1 都基于文件系统 + 约定，不引入数据库或运行时
2. **Skill 不重复方法**：Skill 引用方法文件，不复制方法内容
3. **模板在 AIOEP，实例在项目**：AIOEP 仓库提供模板，项目仓库产出实例
4. **渐进增强**：每个版本只增加最小必要能力，通过 ERP 验证后再扩展
5. **AI 可执行**：所有设计都要考虑 "AI 能不能直接按这个执行"

---

## 变更记录

| 版本 | 日期 | 修改内容 |
|------|------|---------|
| v1.0.0 | 2026-02-17 | 完整创建：8 模块详细设计 + 依赖关系 + 开发顺序 + 版本矩阵 |
